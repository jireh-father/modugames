# Zombie World - Total Product Requirements Document (PRD)

> **Version:** v3.1.1
> **Date:** 2026-03-01
> **Status:** 구현 완료 (Phase 1~4)
> **Platform:** 모바일 웹 (HTML5 Canvas, 540x960px)
> **배포 URL:** https://jireh-father.github.io/modugames/prototypes/zombie-world/
> **저장소:** https://github.com/jireh-father/modugames

---

## 목차

1. [제품 개요](#1-제품-개요)
2. [기술 스택 및 아키텍처](#2-기술-스택-및-아키텍처)
3. [화면 구성 및 UI/UX](#3-화면-구성-및-uiux)
4. [월드 시스템 (Chunk-Based World)](#4-월드-시스템-chunk-based-world)
5. [플레이어 시스템](#5-플레이어-시스템)
6. [무기 시스템 (7종)](#6-무기-시스템-7종)
7. [좀비 시스템 (8종)](#7-좀비-시스템-8종)
8. [건물 시스템 (20종)](#8-건물-시스템-20종)
9. [건물 내부 시스템](#9-건물-내부-시스템)
10. [탈것 시스템 (4종)](#10-탈것-시스템-4종)
11. [생존 시스템](#11-생존-시스템)
12. [낮/밤 주기 및 날씨](#12-낮밤-주기-및-날씨)
13. [소리 시스템](#13-소리-시스템)
14. [아이템 시스템](#14-아이템-시스템)
15. [동물 시스템 (5종)](#15-동물-시스템-5종)
16. [타워 및 성벽 시스템](#16-타워-및-성벽-시스템)
17. [베이스 캠프](#17-베이스-캠프)
18. [경로탐색 (A* Pathfinding)](#18-경로탐색-a-pathfinding)
19. [입력 시스템 (멀티터치)](#19-입력-시스템-멀티터치)
20. [세이브/로드 시스템](#20-세이브로드-시스템)
21. [점수 및 콤보 시스템](#21-점수-및-콤보-시스템)
22. [파티클 시스템](#22-파티클-시스템)
23. [파일 구조](#23-파일-구조)
24. [배포 및 캐시 관리](#24-배포-및-캐시-관리)
25. [버전 히스토리](#25-버전-히스토리)

---

## 1. 제품 개요

### 1.1 비전

Zombie World는 **탑다운 2D 오픈월드 서바이벌 슈팅 게임**이다. 플레이어는 좀비로 가득한 폐허 도시에서 생존하며, 베이스 캠프를 거점으로 무한히 펼쳐지는 청크 기반 월드를 탐험한다. 건물 내부 수색, 탈것 운용, 자원 관리, 성벽 방어를 통해 최대한 오래 살아남는 것이 목표이다.

### 1.2 핵심 게임 루프

```
탐험 → 건물 진입 → 아이템 수집 → 좀비 전투 → 거점 귀환 → 수리/수면/저장 → 반복
```

### 1.3 핵심 특징

- **무한 오픈월드**: 시드 기반 절차적 생성으로 무한 확장
- **소리 기반 좀비 AI**: 좀비가 시각이 아닌 소리에 반응, 전략적 플레이 유도
- **실제 무기 조작**: 탄창 분리, 약실 장전, 활 시위 당기기 등 물리적 조작
- **생존 요소**: 배고픔, 피로, 낮/밤, 날씨에 따른 전략적 생존
- **탈것 시스템**: 4종 탈것으로 빠른 탐험, 소음과 연료 관리 트레이드오프

### 1.4 타겟 사양

| 항목 | 사양 |
|------|------|
| 캔버스 크기 | 540 x 960 px |
| 타겟 FPS | 60fps |
| 브라우저 | Chrome, Safari (모바일 웹) |
| 입력 | 터치 (멀티터치 지원) |
| 저장소 | localStorage |
| 서버 | 없음 (완전 클라이언트) |

---

## 2. 기술 스택 및 아키텍처

### 2.1 기술 스택

| 기술 | 용도 |
|------|------|
| Vanilla JavaScript (ES6 Modules) | 게임 로직 전체 |
| HTML5 Canvas 2D | 렌더링 |
| Web Audio API | 오디오 합성 (외부 파일 없음) |
| localStorage | 세이브/로드, 최고 기록 |
| GitHub Pages (gh-pages 브랜치) | 배포 |
| Playwright MCP | 비주얼 테스트 |

### 2.2 아키텍처 개요

```
index.html
  └─ js/main.js (게임 루프: requestAnimationFrame)
       ├─ game.js (게임 상태 중앙 저장소)
       ├─ input.js (멀티터치 입력 시스템)
       ├─ world.js (청크 생성/관리/전환)
       ├─ renderer.js (필드 배경/시각 효과)
       ├─ player.js (플레이어 이동/상태)
       ├─ zombies.js (좀비 AI/스폰/물리)
       ├─ buildings.js (건물 생성/렌더링)
       ├─ interior.js (건물 내부 시스템)
       ├─ vehicle.js (탈것 시스템)
       ├─ weather.js (날씨 시스템)
       ├─ hud.js (HUD 렌더링)
       ├─ 무기 모듈 (pistol/bow/sniper/mg/crossbow/flamethrower/flashlight)
       ├─ wall.js / tower.js (성벽/타워)
       ├─ items.js / inventory.js (아이템/인벤토리)
       ├─ pathfinding.js (A* 경로탐색)
       ├─ fatigue.js (피로 시스템)
       ├─ save.js (세이브/로드)
       ├─ worldmap.js (세계지도 UI)
       ├─ daynight.js (낮/밤 주기)
       ├─ animals.js (동물 시스템)
       ├─ audio.js (Web Audio 합성)
       ├─ particles.js (파티클)
       ├─ hazards.js (위험 지역)
       ├─ aiming.js (조준 다이얼)
       └─ projectiles.js (투사체)
```

### 2.3 게임 루프

```javascript
// main.js - 핵심 루프 구조
function update(dt) {
  if (world.transitioning) { updateTransition(dt); return; }
  if (state.screen === 'interior') { updateInterior(dt); return; }
  if (state.screen !== 'playing') return;

  state.worldTime += dt;
  updateDayNight(dt);
  updateWeather(dt);
  updatePlayer(dt);
  updateZombies(dt);
  updateProjectiles(dt);
  updateItems(dt);
  updateAnimals(dt);
  updateVehicle(dt);
  updateFatigue(dt);
  updateSounds(dt);
  updateAdjacentChunks(dt);
  // ... 등
}

function draw(ctx) {
  drawField(ctx);          // 배경
  drawBuildings(ctx);      // 건물
  drawVehicles(ctx);       // 탈것
  drawItems(ctx);          // 아이템
  drawAnimals(ctx);        // 동물
  drawZombies(ctx);        // 좀비
  drawPlayer(ctx);         // 플레이어
  drawProjectiles(ctx);    // 투사체
  drawParticles(ctx);      // 파티클
  drawEdgeArrows(ctx);     // 맵 이동 화살표
  drawNightOverlay(ctx);   // 밤 오버레이
  drawWeatherOverlay(ctx); // 날씨 오버레이
  drawHUD(ctx);            // HUD
  drawControls(ctx);       // 하단 컨트롤
}
```

---

## 3. 화면 구성 및 UI/UX

### 3.1 화면 레이아웃

```
┌────────────────────────────┐ y=0
│ [HP][좌표/Day][배고픔][피로]│ ← HUD (48px)
├────────────────────────────┤ y=48 (FIELD_TOP)
│                            │
│  좀비 스폰 영역 (상단)      │ y=48~150
│                            │
│  건물/장애물 + 좀비/아이템  │
│  폐허 도시 필드             │
│                            │
│  ───[문]───[문]───[문]──── │ y=520 (성벽, 베이스맵 전용)
│  [타워L][타워C][타워R]      │ y=590 (타워, 베이스맵 전용)
│                            │
├────────────────────────────┤ y=640 (FIELD_BOTTOM)
│ [무기슬롯 탭바]             │ y=640~680
│ [아이템 인벤토리 바]         │ y=680~715
│                            │
│  무기조작  ╭반원╮  무기조작  │ y=715~960
│           │다이얼│          │ ← 조준 다이얼
│           ╰────╯           │
└────────────────────────────┘ y=960
```

### 3.2 화면 상태 (Screens)

| 상태 | 설명 | 입력 |
|------|------|------|
| `title` | 시작 화면. 게임 제목, TAP TO START, 버전 표시 | 탭→playing |
| `playing` | 메인 게임플레이 | 풀 인터랙션 |
| `paused` | 일시정지 메뉴 | 재개/설정 |
| `gameover` | 게임오버. 점수, 최고기록, NEW GAME 버튼 | 탭→title |
| `worldmap` | 전체 화면 세계지도 오버레이 | 탭→playing |
| `interior` | 건물 내부 전체화면 오버레이 | 이동/전투/나가기 |
| `settings` | 설정 화면 (진동, 소리) | 토글/돌아가기 |

### 3.3 HUD 구성 (상단 48px)

| 요소 | 위치 | 내용 |
|------|------|------|
| 좌측 | x=10~130 | 플레이어 HP 바 (빨강) |
| 중앙 | x=130~370 | 좌표 (BASE 또는 (cx,cy)) + Day N |
| 우측 상단 | x=370~440 | 배고픔 바 (주황) + 피로 바 (청록) |
| 우측 | x=440~530 | 세계지도 버튼 [M] |
| 탑승 중 | 상단 | 연료 게이지 |

### 3.4 컨트롤 영역 (하단 y=640~960)

```
y=640~680: 무기 슬롯 탭바 (8개: pistol, bow, sniper, mg, crossbow, flamethrower, flashlight, pouch)
y=680~715: 아이템 인벤토리 바 (스크롤 가능, 탭으로 사용)
y=715~960: 무기 조작 영역
           - 좌측: 무기별 액션 버튼 (장전, 탄창 등)
           - 중앙: 반원형 조준 다이얼 (0°~180°, 드래그)
           - 우측: 발사/액션 트리거
```

---

## 4. 월드 시스템 (Chunk-Based World)

### 4.1 핵심 개념

| 항목 | 사양 |
|------|------|
| 청크 크기 | 540 x 592px (1 뷰포트 필드 영역) |
| 좌표 | (cx, cy) 정수 좌표, 본부=(0,0) |
| 생성 | 시드 기반 절차적 생성 |
| 영속성 | 한번 생성된 청크 구조 유지, 상태 변화(루팅 등)는 delta로 저장 |

### 4.2 시드 기반 난수

```javascript
// 청크 좌표 → 고유 시드
chunkSeed = (worldSeed + cx * 73856093 + cy * 19349663) & 0x7fffffff

// 시드 기반 LCG 난수 생성기
function seededRng(seed) {
  let s = seed | 0;
  return () => { s = (s * 16807) % 2147483647; return (s & 0x7fffffff) / 2147483647; };
}
```

### 4.3 청크 상태 (ChunkState)

```javascript
{
  cx, cy,              // 좌표
  seed,                // 고유 시드
  isBase,              // 본부 여부 (0,0)
  buildings: [],       // 건물 목록
  zombieConfig: {      // 좀비 배치 설정
    types,             // 출현 좀비 종류
    density,           // 밀도 (수량)
    hpMul,             // HP 배율 (거리 비례)
    speedMul,          // 속도 배율
  },
  animalCount,         // 동물 수
  items: [],           // 필드 아이템
  vehicles: [],        // 탈것
  discovered,          // 탐험 여부
  looted,              // 루팅된 건물 목록
  savedZombies,        // 저장된 좀비 상태
  savedAnimals,        // 저장된 동물 상태
  savedItems,          // 저장된 아이템 상태
  savedVehicles,       // 저장된 탈것 상태
}
```

### 4.4 청크 활성화 계층

| 계층 | 범위 | 처리 | 렌더링 |
|------|------|------|--------|
| **Active** | 현재 청크 | 풀 시뮬레이션 | 풀 렌더링 |
| **Tick-lite** | 인접 8개 | 소리 전파 시 좀비 1/10속도 이동만 | 없음 |
| **Frozen** | 나머지 | 없음 | 없음 |

### 4.5 이동 규칙

| 위치 | 이동 가능 방향 |
|------|-------------|
| 본부 (0,0) | 상/좌/우 (하 불가) |
| 기타 청크 | 상/하/좌/우 모두 |

### 4.6 맵 전환

- **트리거**: 맵 가장자리 화살표 아이콘 탭 (자동 전환 없음)
- **전환 방식**: 슬라이드 애니메이션 (0.3초, smoothstep 이징)
- **플레이어 위치**: 반대편 가장자리에서 출현
  - 예: 왼쪽으로 이동 → 새 맵의 우측 가장자리 `(W - size - 1, y)`
- **전환 중**: 게임 업데이트 정지, 슬라이드 오버레이 표시

### 4.7 가장자리 화살표

- **위치**: 각 가장자리 중앙 (고정)
- **표시**: 항상 보임 (최소 알파 0.25), 가까이 가면 밝아짐
- **히트 영역**: 반경 20px 원형
- **동작**: 탭 시 해당 방향으로 맵 전환 (거리 <30px면 즉시, 아니면 경로탐색 후 자동 전환)
- **조건**: `canMove()` 체크하여 이동 불가 방향은 숨김

### 4.8 난이도 스케일링

- 본부와의 거리에 비례:
  - 좀비 밀도: `15 + dist * 5 + rand * 10` (최대 60)
  - 좀비 HP: `1 + dist * 0.1` 배율
  - 좀비 속도: `1 + min(dist * 0.03, 0.5)` 배율
- 좀비 타입 분포:
  - 30%: 단일 타입
  - 50%: 2~3 타입 혼합
  - 20%: 전 타입 혼합

### 4.9 세계지도

- HUD 우측 [M] 버튼으로 열기
- 전체화면 오버레이 (반투명 배경)
- 탐험한 청크만 표시 (미탐험 = 안개)
- 본부: 파란 타일, 탐험 지역: 녹색 타일
- 현재 위치: 깜빡이는 흰색 마커
- 탭하여 닫기

---

## 5. 플레이어 시스템

### 5.1 기본 속성

| 속성 | 기본값 | 설명 |
|------|--------|------|
| HP | 100 | 0이면 게임오버 |
| 이동 속도 | 220 px/s | HP, 피로, 날씨에 의해 감소 |
| 크기 | 16px 반경 | 충돌 반경 |
| 위치 | (270, 590) | 시작 위치 (중앙 타워) |

### 5.2 이동 시스템

- **터치 이동**: 필드 탭 → A* 경로탐색으로 자동 이동
- **건물 우회**: 경로가 건물을 피함
- **벽 문 경유**: 성벽 통과 시 문을 통해 우회
- **속도 감쇄**:
  - HP 비례: `max(0.3, hp/maxHp)` 배율
  - 피로 50 이하: 0.8배
  - 피로 25 이하: 0.6배
  - 날씨: 비 0.9배, 폭풍 0.8배
  - 신발: 소음 감소 (속도 영향 없음)
- **경계 클램핑**: 필드 영역 밖으로 못 나감
- **경계 충돌 시**: 이동 중단 (끼임 방지)

### 5.3 상태 전환

```
[타워 위] ←→ [지상] → [탈것 탑승]
    ↑             ↓           ↓
 올라가기     건물 진입    하차
 (탭타워)    (탭건물)    (하차버튼)
```

- **타워 위**: 안전, 좀비 직접 공격 없음 (타워 HP만 감소)
- **지상**: 좀비 접촉 시 HP 감소
- **탈것 탑승**: 빠른 이동, 좀비 충돌 데미지

### 5.4 이동 소음

- 걸을 때: 0.5초마다 소음 발생 (범위 160px, 4x 스케일)
- 신발 아이템:
  - Silent shoes: 소음 15px, 60초
  - Stealth shoes: 소음 0px, 30초

### 5.5 플레이어 렌더링

- 파란 원 (12px 반경)
- 조준 방향에 무기 표시
- 피격 시 빨간 플래시
- 이동 경로: 반투명 점선

---

## 6. 무기 시스템 (7종)

모든 무기는 실제 조작 시뮬레이션을 가진다. 하단 컨트롤 영역에서 탄창 분리, 약실 장전, 시위 당기기 등을 수행한다.

### 6.1 무기 프로필

| 무기 | 사거리 | 공격력 | 발사 소음 | 충격 소음 | 관통 | 특성 |
|------|--------|--------|----------|----------|------|------|
| **Pistol** | 400px | 2 | 480 | 200 | 0 | 반자동, 탄창 10발 |
| **Bow** | 500px | 3 | 0 | 120 | 1 | 무소음, 드로우파워=사거리 |
| **Sniper** | 무한 | 3 | 1000 | 320 | 2 | 볼트액션, 2체 관통 |
| **MG** | 350px | 1 | 720 | 120 | 0 | 연사, 30발 |
| **Crossbow** | 450px | 3 | 120 | 120 | 1 | 크랭크 장전, 볼트 |
| **Flamethrower** | 180px | 3 | 320 | 0 | 0 | 연료 100, 범위 공격 |
| **Flashlight** | 0 | 0 | 0 | 0 | 0 | 밤 시야 확보, 배터리 30초 |

### 6.2 권총 (Pistol)

```
상태 머신:
[탄창 있음, 약실 장전됨] → 발사 → [탄창 있음, 약실 비어있음]
  → 슬라이드 전진 → [약실 장전됨] (탄약이 있으면 자동)
  → 탄창 비었으면: [슬라이드 후퇴] → 탄창 분리 → 새 탄창 삽입 → 슬라이드 릴리즈

조작 UI:
- 좌측: 탄창 분리/삽입 버튼
- 우측: 슬라이드 드래그 (약실 장전)
- 하단: 발사 트리거 탭
```

| 상태 속성 | 설명 |
|----------|------|
| magazineBullets | 탄창 내 탄약 (0~10) |
| magazineMax | 탄창 최대 용량 (10) |
| reserveBullets | 예비 탄약 (시작 52발) |
| chambered | 약실 장전 여부 |
| magazineOut | 탄창 분리 상태 |
| slideBack | 슬라이드 후퇴 상태 |
| specialBullets | 특수탄 (냉동/체인/독) |

### 6.3 활 (Bow)

```
조작:
1. 화살 장착 (nock) - 자동 또는 탭
2. 시위 당기기 (draw) - 드래그로 drawPower 0~1
3. 발사 - 릴리즈 (drawPower = 비행 거리)
4. 건물 넘기기 가능 (포물선)
```

| 상태 속성 | 설명 |
|----------|------|
| arrows | 화살 수 (시작 30) |
| specialArrows | 특수 화살 |
| arrowNocked | 화살 장착 여부 |
| drawPower | 시위 당김 정도 (0~1) |
| drawing | 당기는 중 여부 |

### 6.4 저격총 (Sniper)

```
조작:
1. 볼트 오픈 (배출)
2. 새 탄 삽입 (탄창에서)
3. 볼트 클로즈 (약실 장전)
4. 발사 → 관통 2체
```

| 상태 속성 | 설명 |
|----------|------|
| chambered | 약실 장전 |
| boltOpen | 볼트 상태 |
| magazineBullets | 탄창 (10발) |
| reserveRounds | 예비탄 (시작 50) |

### 6.5 기관총 (MG)

```
조작:
- 발사 버튼 홀드 → 연사
- 30발 매거진, 소진 시 재장전
- 높은 소음 → 대량 좀비 유인
```

| 상태 속성 | 설명 |
|----------|------|
| ammo | 현재 탄약 (30) |
| reserveAmmo | 예비 (시작 270) |
| firing | 연사 중 여부 |
| fireTimer | 발사 쿨다운 |

### 6.6 크로스보우 (Crossbow)

```
조작:
1. 볼트 장전 (loaded)
2. 크랭크 회전 (cranking, 0~1 진행)
3. 코킹 완료 (cocked)
4. 발사 → 관통 1체
```

| 상태 속성 | 설명 |
|----------|------|
| bolts | 볼트 수 (시작 30) |
| loaded | 볼트 장전 |
| crankProgress | 크랭크 진행 (0~1) |
| cocked | 코킹 완료 |

### 6.7 화염방사기 (Flamethrower)

```
조작:
- 발사 버튼 홀드 → 화염 분사
- 연료 소모, 범위 공격 (180px 원뿔)
- 좀비에 불 부착 (burning 1.5초)
- 불붙은 좀비 간 화염 전파
- 비: 연료 2x 소모
- 폭풍: 사용 불가
```

| 상태 속성 | 설명 |
|----------|------|
| fuel | 현재 연료 (100) |
| fuelMax | 최대 연료 |
| reserveFuel | 예비 연료 (시작 200) |
| firing | 분사 중 |

### 6.8 손전등 (Flashlight)

```
조작:
- ON/OFF 토글
- 배터리 게이지 (30초 지속)
- 밤에 조준 방향으로 200px 반경 원형 시야
- 배터리 소진 시 자동 꺼짐
- 배터리 아이템으로 충전
```

---

## 7. 좀비 시스템 (8종)

### 7.1 좀비 타입

| # | 이름 | 색상 | 크기 | HP | 속도 | 벽 데미지/s | 특수 능력 |
|---|------|------|------|----|------|-----------|---------|
| 1 | Walker | 연두 | 보통(12) | 2 | 30 | 2 | 기본. 느리게 직진 |
| 2 | Runner | 빨강 | 작음(8) | 1 | 90 | 1 | 빠른 돌진, 지그재그 |
| 3 | Tank | 보라 | 큼(18) | 8 | 18 | 5 | 높은 HP, 갑옷 |
| 4 | Rammer | 주황 | 큼(16) | 5 | 48 | 15 (1회) | 벽에 돌진 후 일반 공격 |
| 5 | Necromancer | 검정+보라 | 보통(13) | 4 | 18 | 0 | 범위 내 좀비 HP 회복 + 속도 버프 |
| 6 | Splitter | 초록+노랑 | 보통(11) | 3 | 36 | 2 | 사망 시 미니좀비 2마리 분열 |
| 7 | Big One | 짙은빨강 | 매우큼(28) | 20 | 12 | 8 | 보스급, 주변 소환, 대량 아이템 드롭 |
| 8 | Spider | 회색 | 매우작음(5) | 1 | 120 | 1 | 5마리 무리 출현, 좌우 지그재그 |

### 7.2 좀비 AI (소리 기반)

```
[대기/배회] → 소리 감지 → [추적: 소리 위치로 이동] → 벽/타워/플레이어 접촉 → [공격]
     ↑                                                              │
     └── 소리 없음 + 목표 지점 도착 ─────────────────────────────────┘
```

- **소리 감지**: `soundSources` 배열에서 범위 내 소리를 감지
- **우선 순위**: 가장 큰 소리(loudness)에 반응
- **직선 이동**: A* 없음, 소리 방향으로 직선 이동
- **건물 충돌**: 벽에 막히면 제자리걸음 (우회 안 함)
- **소리 전파**: 이동 중 좀비도 소음 발생 → 주변 좀비 유인 (체인 반응)

### 7.3 좀비 물리

#### 분리 물리 (Separation Force)
- 좀비 간 거리 < `(sizeA + sizeB) * 0.8`: 반발력 적용
- 반발력 = `overlap * 0.5` (겹침의 50% 만큼 밀어냄)
- 자연스럽게 무리가 넓게 퍼짐, 완전 겹침 방지

#### 벽 압력 시스템
- 벽에 직접 닿은 좀비: 기본 `wallDmg` 적용
- 벽 앞 50px 이내 좀비: "압력 기여자" (+0.5)
- 총 벽 데미지 = `기본 wallDmg + 압력`
- 최대: 직접 공격자 수 × 3배

#### 화염 전파
- 불붙은 좀비(burning)가 다른 좀비와 10px 이내 접촉 시 전파
- 전파된 좀비도 동일 burning 지속시간 (1.5초)
- 연쇄 전파 가능 (A→B→C)

### 7.4 밤 좀비 버프

- 속도: 1.3배 (밤 시간)
- 데미지: 1.2배
- 눈(빨간 점 2개)만 보임 (손전등 범위 밖)

---

## 8. 건물 시스템 (20종)

### 8.1 건물 종류 및 특성

| # | 종류 | 가중치 | 특징 아이템 | 좀비 확률 | 비주얼 아이콘 |
|---|------|--------|-----------|---------|-------------|
| 1 | House (주택) | 15 | 음식, 의약품 | 30% | H |
| 2 | Apartment (아파트) | 10 | 음식, 의류, 잡화 | 40% | A |
| 3 | Convenience (편의점) | 12 | 식량, 음료, 잡화 | 50% | $ |
| 4 | Supermarket (슈퍼마켓) | 5 | 대량 식량, 음료 | 60% | SM |
| 5 | Gun Shop (무기상) | 3 | 탄약, 무기 | 70% | G |
| 6 | Police Station (경찰서) | 2 | 특수무기, 방탄복 | 80% | P |
| 7 | Hospital (병원) | 3 | 의약품, 메디킷 대량 | 60% | + |
| 8 | Pharmacy (약국) | 8 | 의약품 소량 | 30% | Rx |
| 9 | Warehouse (창고) | 6 | 대량 랜덤 자원 | 50% | W |
| 10 | Factory (공장) | 4 | 연료, 기계부품, 폭탄재료 | 40% | F |
| 11 | Gas Station (주유소) | 5 | 연료, 차량수리킷 | 30% | GS |
| 12 | School (학교) | 5 | 잡화 다량, 가방 | 50% | Sc |
| 13 | Church (교회) | 4 | 소량 잡화 (안전지대) | 10% | Ch |
| 14 | Library (도서관) | 4 | 지도 아이템 | 20% | Li |
| 15 | Fire Station (소방서) | 3 | 소화기, 도끼 | 40% | FS |
| 16 | Restaurant (식당) | 8 | 조리된 음식 대량 | 40% | R |
| 17 | Garage (정비소) | 5 | 차량수리킷, 연료 | 30% | Ga |
| 18 | Military Base (군사기지) | 1 | 고급무기, 대량탄약 | 90% | M |
| 19 | Ruin (폐건물) | 10 | 소량 랜덤 | 60% | (없음) |
| 20 | Bunker (지하벙커) | 1 | 희귀 아이템, 대량 보급 | 90% | B |

### 8.2 건물 생성

- 비베이스 청크에서 6~13개 랜덤 배치
- 크기: 40~120px (가로) × 40~80px (세로)
- 건물 간 최소 20px 간격 (겹침 방지)
- 도로(빈 공간)가 연결되도록 보장
- 30% 확률로 `ruined` (금간 표현)
- 베이스맵: 건물 없음

### 8.3 건물 렌더링

- 종류별 고유 색상 및 악센트 라인
- 지붕 스트립 (상단 3px, 악센트 색)
- 타입 아이콘/라벨 중앙 표시
- 부서진 건물: 금간 오버레이
- 루팅된 건물: 50% 어둡게
- 입구 표시: 하단 중앙 문 아이콘 + 가까이 가면 "ENTER" 힌트

---

## 9. 건물 내부 시스템

### 9.1 진입/퇴장

- **진입**: 건물 근처(60px)에서 탭 → 경로탐색 → 도착 후 자동 진입
- **퇴장**: EXIT 버튼 또는 출구 탭
- **화면**: 전체화면 내부 뷰로 전환

### 9.2 내부 구조

- 전체 화면 (540x960) 내 방 하나 렌더
- 벽/바닥 렌더링 (어두운 톤)
- 건물 유형 제목 상단 표시
- 아이템: 노란 발광 점으로 표시
- 좀비: 초록 원으로 표시
- 플레이어: 파란 원으로 표시

### 9.3 내부 전투

- 플레이어: 탭으로 이동, 무기 사용 가능
- 좀비: 100px 이내 감지 → 추적 → 접촉 시 2hp/s 데미지
- 좀비 사망 시 사라짐 (드롭 없음)
- 플레이어 사망 시 게임오버

### 9.4 루트 테이블

건물 유형별 아이템 드롭 테이블:

| 건물 | 가능 아이템 | 수량 | 내부 좀비 |
|------|-----------|------|----------|
| House | food, medkit, brick | 1~3 | 0~1 |
| Supermarket | food(x3), medkit | 3~8 | 2~4 |
| Gun Shop | bullet(x2), arrow, bolt | 2~5 | 2~3 |
| Military | bullet(x3), bomb, medkit | 4~8 | 4~5 |
| Bunker | bullet(x2), medkit, bomb, food | 5~10 | 3~5 |
| Church | food, medkit | 0~2 | 0~1 |

### 9.5 침대 (수면 가능 건물)

- **주택, 아파트**: 침대 있음 → 수면/세이브 가능
- 기타 건물: 침대 없음

---

## 10. 탈것 시스템 (4종)

### 10.1 탈것 종류

| 종류 | 속도 | 소음 | 연료 최대 | 적재량 | 충돌 데미지 | 색상 |
|------|------|------|----------|--------|-----------|------|
| Bicycle (자전거) | 400 | 0 | 무한 | 1칸 | 1 | #88bbff |
| Motorcycle (오토바이) | 600 | 320 | 50 | 3칸 | 3 | #dd8844 |
| Car (승용차) | 800 | 480 | 100 | 8칸 | 5 | #aaaacc |
| Truck (트럭) | 500 | 480 | 150 | 20칸 | 8 | #889966 |

### 10.2 스폰 규칙

- 베이스맵: 탈것 없음
- 비베이스: 0~2대 랜덤 (건물 피해서 배치)
- 확률: 자전거 30%, 오토바이 25%, 승용차 25%, 트럭 15%, 없음 5%
- 주유소/차고 청크에서 발견 확률 증가

### 10.3 조작

- **탑승**: 탈것 30px 이내 탭
- **하차**: 하차 버튼 탭
- **이동**: 탑승 중 터치로 이동 (속도 배율 적용)
- **연료**: 이동 시 소모. 자전거는 연료 불요
- **연료 보충**: 연료 아이템 사용 (+25)
- **연료 소진**: 자동 하차, broken 상태

### 10.4 충돌

- 탑승 이동 중 좀비와 겹치면 `hitDmg` 데미지 + 밀어내기
- 탈것 히트박스: bicycle 12, motorcycle 16, car 24, truck 32

### 10.5 소음

- 이동 중 탈것 소음 발생 (자전거 제외)
- 소음 범위 = 탈것 설정의 noise 값
- 대량 좀비 유인 → 속도 vs 은밀함 트레이드오프

### 10.6 영속성

- 청크 전환 시 탈것 상태 저장/복원
- 탑승 중 맵 경계 → 탈것도 함께 이동
- 세이브 데이터에 포함

---

## 11. 생존 시스템

### 11.1 배고픔 (Hunger)

| 항목 | 값 |
|------|---|
| 최대치 | 100 |
| 소모 속도 | 100 / 240초 (4분에 소진) |
| 0일 때 | HP 5/초 감소 |
| 회복 | 음식 아이템 사용 (+30) |
| 시작 음식 | 5개 |

### 11.2 피로도 (Fatigue)

| 항목 | 값 |
|------|---|
| 최대치 | 100 |
| 소모 속도 | 100 / 600초 (10분에 소진) |
| 50 이하 | 이동속도 20% 감소 |
| 25 이하 | 이동속도 40% 감소 + 조준 흔들림 |
| 0 | 강제 수면 (30초, 조기 깨어남 불가) |

### 11.3 수면

| 수면 장소 | 소요 시간 | 비고 |
|----------|----------|------|
| 본부 침대 | 10초 | 가장 빠른 회복 |
| 주택/아파트 침대 | 20초 | 건물 내부에서 |
| 야외 | 60초 | 위험! 무방비 상태 |
| 강제 수면 | 30초 | 피로 0 시 자동 |

- 수면 중: 어두운 오버레이 + "Sleeping..." 텍스트 + 진행 바
- 수면 완료 시 자동 세이브
- 좀비는 수면 중에도 활동 (야외 수면 위험)

---

## 12. 낮/밤 주기 및 날씨

### 12.1 낮/밤 주기

| 항목 | 값 |
|------|---|
| 전체 주기 | 360초 (6분) |
| 낮 | 240초 (4분) |
| 밤 | 120초 (2분) |
| 일자 계산 | `floor(worldTime / 360) + 1` |

- 밤: 검은 오버레이, 좀비 눈만 보임
- 손전등: 200px 원형 시야 확보
- 타워 서치라이트: 120px 원형, 8초 주기 회전

### 12.2 날씨 시스템

| 날씨 | 가중치 | 시야 | 이동 | 화염방사기 | 소리 범위 |
|------|--------|------|------|----------|----------|
| Clear (맑음) | 40 | 100% | 100% | 정상 | 100% |
| Rain (비) | 30 | 70% | 90% | 연료 2x | 50% (빗소리 커버) |
| Fog (안개) | 20 | 40% | 100% | 정상 | 100% |
| Storm (폭풍) | 10 | 50% | 80% | 사용 불가 | 130% (바람 전달) |

### 12.3 날씨 분포

- 5x5 청크 블록이 동일 날씨 공유
- 날씨 변경 주기: 게임 시간 600초(10분)마다
- 시드 기반 결정 (시간 + 블록 좌표)

### 12.4 날씨 렌더링

- **비**: 대각선 파란 스트리크 (선형)
- **안개**: 가장자리 어두운 그래디언트 베일
- **폭풍**: 비 + 주기적 밝은 번개 플래시 + 바람 파티클

---

## 13. 소리 시스템

### 13.1 소리 소스

```javascript
soundSource = {
  x, y,          // 위치
  intensity,     // 현재 강도 (1→0 감쇠)
  range,         // 전파 범위 (px)
  loudness,      // 원본 크기 (밤 보정 전)
  timer,         // 남은 시간
  duration,      // 전체 지속시간
  type,          // generic, weapon, explosion, vehicle, lure
  target,        // 원래 목적지 좌표
}
```

### 13.2 소리 범위 (4x 스케일)

| 등급 | 범위 | 예시 |
|------|------|------|
| 무음 | 0 | 활 발사 |
| 미미 | 120 | 화살 충격, 크로스보우 |
| 작음 | 200 | 탄환 충격 |
| 보통 | 320 | 화염방사기, 저격 충격 |
| 큼 | 480 | 권총 발사 |
| 매우큼 | 720 | 기관총 발사 |
| 폭발급 | 1000 | 저격총 발사 |

### 13.3 소리 수정자

- **밤**: 소리 범위 1.4배
- **비**: 소리 범위 0.5배
- **폭풍**: 소리 범위 1.3배

### 13.4 좀비 소리 전파 (체인 반응)

- 이동 중인 좀비도 0.5초마다 소음 발생 (60px 범위)
- 주변 대기 좀비가 감지 → 추적 시작 → 소음 발생 → 다음 좀비에 전파
- 총성 한 발이 도미노처럼 넓은 영역의 좀비를 유인

### 13.5 크로스맵 소리 전파

- Active 청크의 소리가 경계를 넘으면 인접 Tick-lite 청크 좀비에게 전달
- 경계까지 잔여 범위로 인접 맵 좀비 유인 (1/10 속도)
- 이동한 좀비가 경계를 넘으면 현재 맵에 진입

### 13.6 시각화

- 투명 원형 파동 (매우 희미)
- 외부 링: `alpha = intensity * 0.06`
- 내부 링: `alpha * 1.5`
- 색상: `rgba(200,200,150)` (부드러운 톤)
- 펄스 진폭: `0.02`

---

## 14. 아이템 시스템

### 14.1 아이템 종류 (현재 구현)

| 카테고리 | 아이템 | 효과 |
|---------|--------|------|
| **탄약** | Bullet (권총탄) | 권총 예비탄 +10 |
| | Arrow (화살) | 활 화살 +5 |
| | SniperRound | 저격총 예비탄 +5 |
| | MGAmmo | 기관총 예비탄 +30 |
| | Bolt (볼트) | 크로스보우 볼트 +5 |
| | FuelCan (연료) | 화염방사기 예비연료 +25 |
| **건축** | Brick (벽돌) | 성벽 가장 낮은 구간 +25 HP 또는 업그레이드 |
| **회복** | Medkit (메디킷) | 타워 +30 HP |
| | Food (음식) | 배고픔 +30 |
| | PlayerMedkit | 플레이어 HP +20 |
| **전투** | Mine (지뢰) | 바닥 설치, 접촉 시 반경 60px 폭발 (데미지 5) |
| | Molotov (화염병) | 3초 범위 지속 데미지 (2/s) |
| | Bomb (폭탄) | 화면 전체 좀비 5 데미지 |
| | FreezeBullet (냉동탄) | 다음 3발 적중 시 좀비 3초간 속도 50% 감소 |
| | ChainBullet (전기쥐) | 적중 좀비 + 주변 2마리 체인 데미지 |
| | PoisonBullet (독병) | 적중 좀비 5초간 매초 1 데미지 |
| **버프** | Shield (방어무적) | 5초간 모든 성벽 데미지 무효 |
| | Speed (스피드) | 10초간 발사속도 2배 |
| | MagUp (탄창업) | 피스톨 탄창 +2 (최대 12) |
| **유틸** | Battery (배터리) | 손전등 배터리 충전 |
| | Flashbang (섬광탄) | 범위 좀비 3초 기절 |
| | SilentShoes | 이동 소음 15px, 60초 |
| | StealthShoes | 이동 소음 0px, 30초 |
| **유인** | Toy (장난감) | 15초간 소음 발생 (범위 320) |
| | Firecracker (폭죽) | 10초간 대소음 (범위 720) |
| | Radio (라디오) | 30초간 소음 (범위 480) |
| **차량** | FuelCan | 탈것 연료 +25 |

### 14.2 드롭 규칙

- 좀비 킬 시 15% 확률 드롭
- 금색 좀비: 100% 드롭
- 보스(Big One): 3~5개 동시 드롭
- 콤보 3/5/10/15+ 보너스 드롭
- 필드 아이템: 영구 지속 (시간 소멸 없음)

### 14.3 수집

- 지상에서 아이템 30px 이내 접근 시 자동 수집
- 아이템 탭 → 경로탐색 후 자동 이동 → 수집
- 타워 위에서는 수집 불가

### 14.4 인벤토리

- 하단 아이템 바에 수집된 아이템 표시
- 탭으로 즉시 사용
- 드래그로 벽에 투자 (벽돌 업그레이드)

---

## 15. 동물 시스템 (5종)

### 15.1 동물 종류

| 동물 | 크기 | 속도 | 고기 회복 | 행동 |
|------|------|------|----------|------|
| Chicken (닭) | 12 | 60 | 20 | 빠른 도주 |
| Rabbit (토끼) | 11 | 90 | 15 | 중간 속도 도주 |
| Rat (쥐) | 8 | 120 | 10 | 매우 빠른 도주 |
| Pigeon (비둘기) | 9 | 75 | 12 | 비행 도주 |
| Frog (개구리) | 9 | 40 | 8 | 느린 점프 |

### 15.2 행동

- 스폰: 청크별 2~5마리 (베이스 5마리)
- 평시: 랜덤 배회 (느린 속도)
- 플레이어 100px 이내: 도주 (반대 방향)
- 잡기: 플레이어 25px 이내 접근 시 자동 잡기
- 잡으면: 고기 드롭 → 배고픔 회복

---

## 16. 타워 및 성벽 시스템

**베이스맵 (0,0) 전용** - 다른 맵에서는 표시되지 않음

### 16.1 타워 (3개)

| 타워 | 위치 X | HP |
|------|--------|-----|
| 좌측 | 90 | 200 |
| 중앙 | 270 | 200 |
| 우측 | 450 | 200 |

- Y 위치: 590 (고정)
- 올라가기: 타워 40px 이내 탭 (파괴된 타워 불가)
- 내려오기: Descend 버튼 탭
- 파괴 시: 올라갈 수 없음, 플레이어 강제 하차
- 수리: 벽돌 아이템 +30 HP

### 16.2 성벽 (4구간)

| 속성 | 기본값 |
|------|--------|
| 구간 수 | 4 |
| 각 HP | 100 (업그레이드 시 최대 250) |
| Y 위치 | 520 |
| 시각화 | HP에 따라 초록→노랑→빨강→파괴 |

- 좀비가 벽 공격 → HP 감소
- HP 0 → 구멍, 좀비 통과 가능
- 파괴된 벽 재건: 5초 소요 (내부 좀비 전멸 후)
- 재건 벽: HP 50으로 시작

### 16.3 벽 업그레이드

- 벽돌 아이템 드래그 → 벽 구간에 투자
- 업그레이드당 maxHP +50, 현재 HP 풀 회복
- 최대 3회 업그레이드 (100 → 150 → 200 → 250)
- 시각: 업그레이드 수에 따라 두꺼워짐

### 16.4 벽의 문 (3개)

- 위치: x=135, 270, 405
- 플레이어만 통과 가능 (좀비 불가)
- 경로탐색이 문을 경유하여 벽 양측 이동

---

## 17. 베이스 캠프

### 17.1 개요

베이스맵 (0,0)의 특수 시설. 타워 + 성벽 + 문이 있는 방어 거점.

### 17.2 베이스 캠프 내부

- 타워 영역 탭 → "BASE CAMP" 내부 진입
- 내부 구성:
  - 영구 침대 (10초 수면, 가장 빠른 회복)
  - 자동 세이브 (수면 완료 시)
  - 좀비 없음 (항상 안전)

### 17.3 특수 규칙

- 아래 방향 이동 불가 (본부 내부 개념)
- 타워와 성벽은 베이스맵에서만 표시/작동
- 건물 없음 (빈 공간 + 도로 + 타워/성벽)

---

## 18. 경로탐색 (A* Pathfinding)

### 18.1 그리드

- 셀 크기: 20px
- 그리드: 27 × 30 (필드 영역)
- 건물/벽이 있는 셀: 통행 불가
- 문 위치: 통행 가능
- 8방향 이동 (대각선 포함)

### 18.2 A* 알고리즘

- 플레이어 전용 (좀비는 사용 안 함)
- 맨해튼 휴리스틱
- 경로 시각화: 반투명 점선
- 새 목적지 터치 시 경로 재계산
- 청크 로드 시 그리드 재빌드

### 18.3 특수 경로

- 타워 이동: 가장 가까운 문 경유 → 타워 위치로
- 건물 진입: 건물 입구까지 경로 → 자동 진입
- 가장자리 이동: 화살표 탭 → 가장자리까지 경로 → 자동 전환

---

## 19. 입력 시스템 (멀티터치)

### 19.1 Zone 기반 시스템

```javascript
registerZone(bounds, handlers, priority)
```

- 각 UI 요소가 Zone으로 등록
- 우선순위가 높은 Zone이 먼저 이벤트 소비
- 멀티터치 지원: 이동하면서 발사 가능

### 19.2 Zone 우선순위

| 우선순위 | Zone |
|---------|------|
| 100 | 무기 조작 (슬라이드, 트리거 등) |
| 80 | 아이템 바 |
| 60 | 무기 슬롯 탭바 |
| 50 | 조준 다이얼 |
| 40 | 타워 올라가기/내려오기 |
| 20 | 필드 터치 (이동) |
| 10 | 맵 화살표 |
| 0 | 세계지도 닫기 |

### 19.3 조준 다이얼

- 하단 중앙 반원형 (반경 80px)
- 드래그로 0°~180° 조절 (0=오른쪽, π/2=위, π=왼쪽)
- 360° 전방위 가능
- 발사선: 다이얼 각도 방향으로 점선 표시

---

## 20. 세이브/로드 시스템

### 20.1 저장 시점

- 수면 완료 시 자동 저장

### 20.2 저장 데이터

```javascript
{
  version: 3,                  // 세이브 버전
  score,                       // 점수
  worldTime,                   // 전체 경과 시간
  player: { hp, x, y, ... },  // 플레이어 상태
  inventory: [],               // 인벤토리
  hunger, fatigue,             // 생존 수치
  weapon: currentWeapon,       // 무기 상태
  pistol, bow, sniper, ...     // 각 무기 상세
  worldSeed,                   // 월드 시드
  currentCx, currentCy,        // 현재 청크
  discovered: [],              // 탐험한 청크 목록
  chunks: {},                  // 청크 delta (루팅, 좀비 등)
  currentWeather,              // 현재 날씨
  walls, towers,               // 성벽/타워 상태
}
```

### 20.3 청크 Delta 압축

- 시드로 복원 가능한 정보는 저장하지 않음
- 변경된 사항만 delta로 저장:
  - `looted` 건물 목록
  - 제거된 좀비
  - 수집된 아이템
  - 탈것 상태
- 최대 500개 청크 delta까지

### 20.4 UI

- 타이틀 화면: 세이브 있으면 "CONTINUE" 버튼
- 게임오버: "LOAD SAVE" 또는 "NEW GAME"
- 저장소: `localStorage` (키: `zw_save`)

---

## 21. 점수 및 콤보 시스템

### 21.1 점수 계산

| 요소 | 점수 |
|------|------|
| 좀비 킬 | HP당 10점 |
| 거리 보너스 | 1x~3x (멀리서 킬) |
| 밤 보너스 | 1.5x |
| 콤보 배수 | 1x~∞ (연속 킬) |

### 21.2 콤보

- 연속 킬 시 콤보 카운터 증가
- 일정 시간(3초) 킬 없으면 콤보 리셋
- 콤보 3/5/10/15+: 보너스 아이템 드롭

### 21.3 최고 기록

- `localStorage`에 `zw_best` (최고 점수), `zw_best_wave` (최고 웨이브) 저장
- 게임오버 화면에서 표시

---

## 22. 파티클 시스템

### 22.1 파티클 종류

| 타입 | 트리거 | 시각 |
|------|--------|------|
| Blood | 좀비 피격 | 빨간 점 분산 |
| Spark | 탄환 건물 충돌 | 노란 불꽃 |
| Death | 좀비 사망 | 타입 색상 파편 |
| Muzzle | 총기 발사 | 노란 섬광 |
| Fire | 화염방사기 | 주황/빨강 입자 |
| Explosion | 폭발 | 큰 범위 파편 |
| Smoke | 차량/폭발 | 회색 연기 |

### 22.2 파티클 속성

```javascript
{
  x, y,          // 위치
  vx, vy,        // 속도
  life,          // 남은 수명
  size,          // 크기
  color,         // 색상
  alpha,         // 투명도 (수명에 비례 감소)
  gravity,       // 중력
}
```

---

## 23. 파일 구조

### 23.1 전체 파일 목록 (36개 JS 파일)

| 파일 | 줄 수 (예상) | 역할 |
|------|-------------|------|
| `main.js` | ~400 | 게임 루프, 업데이트/드로우 통합 |
| `game.js` | ~410 | 게임 상태 중앙 저장소, 상수, 유틸 |
| `input.js` | ~300 | 멀티터치 Zone 기반 입력 |
| `world.js` | ~500 | 청크 생성/관리/전환, 시드 RNG |
| `worldmap.js` | ~100 | 세계지도 UI |
| `renderer.js` | ~300 | 필드 배경, 발사선, 소리 시각화, 화살표 |
| `player.js` | ~500 | 플레이어 이동, 상태, 전투 |
| `zombies.js` | ~600 | 좀비 AI, 스폰, 분리물리, 화염전파 |
| `buildings.js` | ~250 | 건물 생성/렌더링, 타입별 시각 |
| `interior.js` | ~400 | 건물 내부 생성/렌더링/전투 |
| `vehicle.js` | ~350 | 탈것 타입/스폰/렌더/이동/연료/충돌 |
| `weather.js` | ~250 | 날씨 생성/오버레이/효과 |
| `hud.js` | ~500 | HUD, 타이틀, 게임오버, 일시정지 |
| `items.js` | ~300 | 아이템 드롭/렌더/수집 |
| `inventory.js` | ~200 | 인벤토리 바, 아이템 사용 |
| `pathfinding.js` | ~200 | A* 경로탐색, 그리드 관리 |
| `fatigue.js` | ~100 | 피로/수면 시스템 |
| `save.js` | ~150 | 세이브/로드, 청크 delta 직렬화 |
| `daynight.js` | ~200 | 낮/밤 주기, 오버레이 |
| `animals.js` | ~200 | 동물 스폰/렌더/AI |
| `wall.js` | ~250 | 성벽 4구간, 업그레이드, 문 |
| `tower.js` | ~200 | 타워 3개, 올라가기/내려오기 |
| `aiming.js` | ~200 | 반원 다이얼 조준, 피로 흔들림 |
| `projectiles.js` | ~250 | 투사체 이동/충돌/관통 |
| `particles.js` | ~150 | 파티클 생성/업데이트/렌더 |
| `hazards.js` | ~100 | 위험 지역 (화염/독) |
| `audio.js` | ~300 | Web Audio 합성, 무기/좀비 사운드 |
| `pistol.js` | ~250 | 권총 조작 UI/로직 |
| `bow.js` | ~250 | 활 조작 UI/로직 |
| `sniper.js` | ~250 | 저격총 조작 UI/로직 |
| `mg.js` | ~200 | 기관총 조작 UI/로직 |
| `crossbow.js` | ~200 | 크로스보우 조작 UI/로직 |
| `flamethrower.js` | ~200 | 화염방사기 조작 UI/로직 |
| `flashlight.js` | ~100 | 손전등 조작 UI/로직 |
| `gyro.js` | ~50 | 자이로스코프 입력 |
| `settings.js` | ~100 | 설정 화면 |

---

## 24. 배포 및 캐시 관리

### 24.1 배포 플로우

```bash
# 1. main 브랜치에 커밋/푸시
git push origin main

# 2. gh-pages 브랜치 동기화
git checkout gh-pages
git merge main --no-edit
git push origin gh-pages
git checkout main
```

- GitHub Pages는 `gh-pages` 브랜치에서 배포
- 소스 경로: `/` (루트)
- URL: `https://jireh-father.github.io/modugames/prototypes/zombie-world/`

### 24.2 캐시 버스팅

- 모든 JS import에 `?v=VERSION_NUMBER` 쿼리 파라미터 사용
- 현재 버전: `?v=311`
- 버전 업데이트 시 모든 34개 JS 파일 + index.html의 `?v=` 값을 동시에 변경
- `game.js`의 `VERSION` 상수도 함께 업데이트

### 24.3 버전 표시

- 타이틀 화면 "TAP TO START" 아래에 흰색 12px 폰트로 버전 표시
- `game.js`: `export const VERSION = 'v3.1.1';`

---

## 25. 버전 히스토리

### v1.0 (2026-02-27) - 초기 타워 디펜스
- Tactical Range 코드베이스 기반
- 단일 타워, 성벽 4구간
- 5종 무기 (권총, 활, 저격총, 기관총, 크로스보우)
- 8종 좀비
- 웨이브 시스템 (Day = 5 Waves)
- 낮/밤 주기
- 반원 다이얼 조준

### v2.0 (2026-02-28) - 서바이버 재설계
- 플레이어 캐릭터 추가 (타워 ↔ 지상 이동)
- 타워 3개 (좌/중/우)
- A* 경로탐색
- 건물 장애물 (랜덤 배치)
- 소리 기반 좀비 AI
- 아이템 영구 지속, 바닥 수집
- 벽의 문 3개

### v2.1 (2026-02-28) - 11 Feature Upgrade
- 손전등 시스템
- 소리 전파 체인 반응
- 360° 전방위 조준
- 화염방사기 추가
- 배고픔 + 동물 시스템 (5종)
- 플레이어 이동 소음
- 신발 아이템 2종
- HP 기반 속도 변화

### v3.0 - Phase 1 (2026-03-01) - 무한 오픈월드
- 청크 기반 무한 맵 (시드 절차적 생성)
- 맵 전환 (슬라이드 애니메이션)
- 웨이브 시스템 제거 → 자유 탐험
- 좀비 분리 물리 (겹침 방지)
- 벽 압력 시스템
- 화염 전파
- 무기 밸런스 조정 (저격총 관통 2, 화염방사기 DPS 절반)
- 소리 시각화 약화
- 동물 크기 1.5배, 잡기 거리 확대
- 세계지도 UI
- 크로스맵 소리 전파

### v3.0 - Phase 2 (2026-03-01) - 건물 내부 + 생존
- 20종 건물 타입별 시각 구분
- 건물 내부 진입/탐색/전투
- 건물별 루트 테이블
- 피로도/수면 시스템
- 세이브/로드 (localStorage)
- 루팅 상태 영속

### v3.0 - Phase 3 (2026-03-01) - 탈것 + 날씨
- 4종 탈것 (자전거, 오토바이, 승용차, 트럭)
- 탈것 탑승/하차/연료/충돌/소음
- 탈것 청크 간 이동 및 영속
- 날씨 시스템 4종 (맑음, 비, 안개, 폭풍)
- 날씨 렌더링 오버레이
- 날씨 → 게임플레이 효과

### v3.0 - Phase 4 (2026-03-01) - 베이스캠프 + 폴리시
- 베이스 캠프 내부 (수면/세이브)
- 벽 업그레이드 시스템 (벽돌 3단계)
- 밸런스 조정 (배고픔 240초, 시작 음식 5개, 속도 220)
- 성능 최적화 (좀비 캡, 청크 캐시 제한)

### v3.1.0 (2026-03-01) - 버그 수정 + QoL
- 맵 전환 왕복 방지 (화살표 클릭만으로 전환)
- 모바일 화살표 항상 표시 (최소 알파)
- 경계 끼임 방지 (클램핑 시 이동 중단)
- 건물 입구 시각 표시 (문 아이콘 + ENTER 힌트)
- 버전 표시 (타이틀 화면)
- 캐시 버스팅 시스템 (v=311)

### v3.1.1 (2026-03-01) - 현재 버전
- 버전 번호 반영 (v3.1.1)
- 캐시 버전 동기화 (v=311)

---

## 부록 A: 주요 좌표 상수

| 상수 | 값 | 용도 |
|------|---|------|
| W | 540 | 캔버스 가로 |
| H | 960 | 캔버스 세로 |
| HUD_H | 48 | HUD 높이 |
| FIELD_TOP | 48 | 필드 시작 Y |
| WALL_Y | 520 | 성벽 중심 Y |
| TOWER_Y | 590 | 타워 Y |
| FIELD_BOTTOM | 640 | 필드 끝 Y |
| CONTROLS_TOP | 672 | 컨트롤 영역 시작 |
| CONTROLS_BOTTOM | 960 | 컨트롤 영역 끝 |
| SLOT_H | 40 | 무기 슬롯 높이 |
| ITEM_BAR_H | 35 | 인벤토리 바 높이 |
| DIAL_R | 80 | 조준 다이얼 반경 |

## 부록 B: 키 리소스

- **저장소**: https://github.com/jireh-father/modugames
- **배포**: https://jireh-father.github.io/modugames/prototypes/zombie-world/
- **기획서 위치**: `docs/plans/`
- **PRD 위치**: `.claude/docs/zombie-world-total-prd.md`
- **게임 코드**: `prototypes/zombie-world/js/`
- **배포 브랜치**: `gh-pages`
