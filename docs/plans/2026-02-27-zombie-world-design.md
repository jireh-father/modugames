# Zombie World - Game Design Document

**Date**: 2026-02-27
**Base**: Tactical Range codebase (copy + modify)
**Platform**: Mobile web (HTML5 Canvas, 540x960)

## Overview

타워 디펜스 슈팅 게임. 플레이어는 성벽 안 중앙 타워에서 총을 쏘며 밀려오는 좀비를 막는다. 기존 Tactical Range의 무기 시스템(5종)을 그대로 재활용하되, 화면 구성과 적 시스템을 전면 교체.

## Screen Layout (Top-Down 2D)

```
┌─────────────────────────────┐
│  [Score] [Day/Wave] [Ammo]  │  ← HUD (48px)
├─────────────────────────────┤
│                             │
│  좀비 스폰 영역 (상단)       │  ← y=48 ~ y=200
│                             │
│  필드 (좀비 이동 영역)       │  ← y=200 ~ y=520
│                             │
│  ╔═══╤═══╤═══╤═══╗         │  ← 성벽 4구간 (타원형, y≈520)
│  ║ 1 │ 2 │ 3 │ 4 ║         │     각 구간 HP바 표시
│  ╚═══╧═══╧═╦═╧═══╝         │
│           ▲                  │  ← 타워 (중앙, y≈600)
│        [발사선]              │     조준 방향 점선
├─────────────────────────────┤
│  [Pistol][Bow][Sniper][MG][XBow]│ ← 무기 슬롯 (40px)
├─────────────────────────────┤
│                             │
│  무기조작  ╭반원╮  무기조작   │  ← 컨트롤러 (272px)
│           │다이얼│           │     반원 다이얼 = 조준 각도
│           ╰────╯            │
└─────────────────────────────┘
```

## Aiming System - Half-Circle Dial

- 컨트롤러 하단 중앙에 반원형 다이얼 (시계 상반부)
- 드래그로 각도 조절: 9시(왼쪽 끝) ~ 12시(정면) ~ 3시(오른쪽 끝)
- 타워 위치에서 해당 각도 방향으로 발사선(점선) 표시
- 탄환은 발사선을 따라 직선 이동
- 무기별 탄도:
  - 총기류(피스톨/스나이퍼/MG): 직선, 첫 좀비에 적중
  - 화살/볼트: 거리 조절 가능 (드로우 파워 = 사거리), 중간 좀비 넘기기 가능

## Zombie Types (8 types)

| # | Name | Color | Size | HP | Speed | Wall DMG/s | Special |
|---|------|-------|------|----|-------|-----------|---------|
| 1 | **Walker** (워커) | 연두 | 보통 | 2 | 0.5 | 2 | 기본. 느리게 직진 |
| 2 | **Runner** (러너) | 빨강 | 작음 | 1 | 1.5 | 1 | 빠르게 돌진. 지그재그 |
| 3 | **Tank** (탱커) | 보라 | 큼 | 8 | 0.3 | 5 | 갑옷. 높은 HP |
| 4 | **Rammer** (램더) | 주황 | 큼 | 5 | 0.8 | 15 (1회 돌진) | 성벽에 돌진 후 일반 공격 |
| 5 | **Necromancer** (네크로맨서) | 검정+보라 | 보통 | 4 | 0.3 | 0 | 반경 내 좀비 HP회복+속도버프. 성벽 안 감 |
| 6 | **Splitter** (스플리터) | 초록+노랑 | 보통→작음 | 3 | 0.6 | 2 | 죽으면 미니좀비 2마리 분열 (HP1, 속도1.2) |
| 7 | **Big One** (빅원) | 짙은빨강 | 매우큼 | 20 | 0.2 | 8 | 보스급. 주변 소환. 킬시 대량 아이템 |
| 8 | **Spider** (거미) | 회색 | 매우작음 | 1 | 2.0 | 1 | 5마리씩 무리 출현. 좌우 지그재그 |

### Zombie Behavior
- 스폰: 화면 상단 랜덤 x 위치
- 이동: 성벽 방향(아래)으로 직진 (타입별 패턴 있음)
- 성벽 도달: 가장 가까운 구간 벽 공격 (HP 감소)
- 벽 파괴 시: 구멍으로 침입 → 타워로 직진
- 네크로맨서: 성벽에 직접 안감, 뒤에서 버프 영역 유지
- 거미: 좌우 지그재그하며 빠르게 접근

### Zombie Visual (Minimal Geometric)
- 원(머리) + 타원(몸) + 선(팔다리)
- 걷기 애니메이션: 팔다리 흔들기
- 피격: 빨간 플래시
- 사망: 파편 파티클 (타입 색상)

## Wall & Tower System

### Wall (성벽 4구간)
- 형태: 화면 중하단에 타원형 호(弧) 형태
- 각 구간 HP: 100 (Day 스케일링 없음, 고정)
- 시각: HP에 따라 색상 변화 (초록→노랑→빨강→파괴)
- 파괴 시: 해당 구간에 구멍 표시, 좀비 통과 가능

### Wall Repair
- 벽돌 아이템 사용: 가장 HP 낮은 구간에 +25
- 파괴된 벽 재건: 내부 좀비 전멸 후 5초 소요
- 재건 중에도 다른 구간으로 좀비 공격 가능
- 재건된 벽: HP 50으로 시작 (완전체 아님)

### Tower (타워)
- 위치: 성벽 중앙 안쪽
- HP: 200
- 침입한 좀비가 타워 공격 (동일 데미지 규칙)
- HP 0 = Game Over
- HP 회복 아이템으로 수리 가능 (+30)

## Wave System (Day/Night Cycle)

### Structure: 1 Day = 5 Waves
```
Day N:
  Wave 1 (Dawn ☀)    - 정찰: 워커 소수 + 보급 드랍
  Wave 2 (Day ☀)     - 러시: 러너+워커 혼합
  Wave 3 (Sunset ☀)  - 보급: 금색좀비 등장, 아이템 대량
  Wave 4 (Night 🌙)   - 공성: 탱커+램더, 시야 축소
  Wave 5 (Midnight 🌙) - 보스: 빅원 + 혼합 러시, 시야 최소
```

### Night Effects
- 화면 어두워짐 (검은 오버레이)
- 타워에서 조준 방향으로 원뿔형 손전등 영역만 밝음
- 좀비 눈(빨간 점 2개)만 어둠 속에 보임
- 밤 웨이브 킬 보너스: 1.5배 점수

### Difficulty Scaling (per Day)
- 좀비 수: `baseCount + day * 2`
- 좀비 HP: `baseHP * (1 + day * 0.15)`
- 좀비 속도: `baseSpeed * (1 + day * 0.08)`
- Day 3+: 보스웨이브에 빅원 확정
- Day 5+: 네크로맨서 출현
- Day 8+: 스플리터 출현

### Wave Timing
- 웨이브 사이 휴식: 3초 (벽 보수/아이템 사용 시간)
- Day 사이 휴식: 5초 + "Day N Complete" 배너

## Item System

| Item | Effect | Drop Weight |
|------|--------|-------------|
| **벽돌** (Brick) | 성벽 가장 낮은 구간 +25 HP | 20 |
| **탄약** (5종) | 기존 무기별 탄약 | 각 15 |
| **HP회복** (Medkit) | 타워 +30 HP | 10 |
| **지뢰** (Mine) | 바닥 설치, 좀비 접촉시 반경 60px 폭발 (데미지 5) | 8 |
| **화염병** (Molotov) | 범위 3초 지속데미지 영역 (2/s) | 8 |
| **냉동탄** (Freeze) | 다음 3발 적중시 좀비 3초간 속도 50% 감소 | 6 |
| **전기쥐** (Chain) | 적중 좀비 + 주변 2마리 체인 데미지 | 5 |
| **독병** (Poison) | 적중 좀비 5초간 매초 1 데미지 | 5 |
| **방어무적** (Shield) | 5초간 모든 성벽 데미지 무효 | 3 |
| **스피드부스트** (Speed) | 10초간 발사속도 2배 | 3 |
| **폭탄** (Bomb) | 즉시 사용. 화면 전체 좀비 5 데미지 | 2 |
| **탄창업** (MagUp) | 피스톨 탄창 +2 (최대 12) | 4 |

### Drop Rules
- 좀비 킬시 15% 확률 드랍
- 금색 좀비: 100% 드랍
- 보스(빅원) 킬: 3~5개 동시 드랍
- 콤보 3/5/10/15+ 보너스 드랍
- 아이템 8초 후 소멸

## Weapon System (Reused from Tactical Range)

5종 무기 시스템 그대로 재활용:
1. **Pistol** - 반자동, 탄창 장전
2. **Bow** - 드로우 파워 조절, 포물선
3. **Sniper** - 볼트액션, 관통
4. **MG** - 연사, 오버히트
5. **Crossbow** - 크랭크 장전, 볼트

### Weapon Adaptations for Top-Down
- 발사 방향: 반원 다이얼 각도 방향
- 총기류: 직선 탄도, 첫 좀비에 적중 (관통 무기는 통과)
- 화살/볼트: 드로우 파워 = 사거리, 중간 좀비 넘기기 가능
- MG: 좌우 스프레드가 각도 기준으로 적용
- 스나이퍼: 관통하여 일직선상 모든 좀비 타격

## Scoring
- 좀비 킬 점수: HP 기반 (HP 1당 10점)
- 거리 보너스: 멀리서 킬할수록 높음 (1x~3x)
- 밤 보너스: 1.5x
- 콤보 시스템: 기존과 동일 (연속 킬 배수)
- 웨이브 클리어 보너스: 남은 시간 * 10
- Day 클리어 보너스: 성벽 잔여 HP 합산

## Technical: Reuse Strategy

### Copy Entirely (minimal changes)
- `input.js` - 멀티터치 시스템
- `audio.js` - Web Audio 합성 (좀비 소리 추가만)
- `particles.js` - 파티클 시스템
- `settings.js` - 설정 화면
- `gyro.js` - 자이로스코프
- `pistol.js` - 피스톨 무기
- `bow.js` - 활 무기
- `sniper.js` - 스나이퍼 무기
- `mg.js` - 기관총 무기
- `crossbow.js` - 크로스보우 무기

### Heavy Modification
- `game.js` → 상태에 wall[], tower, zombies[] 추가
- `renderer.js` → 탑다운 2D 렌더링으로 전면 교체
- `targets.js` → `zombies.js`로 교체 (좀비 AI, 스폰, 행동)
- `hud.js` → 성벽 HP바, Day/Night 표시 추가
- `items.js` → 새 아이템 타입들 추가
- `projectiles.js` → 2D 직선/포물선 탄도로 변경
- `aiming.js` → 반원 다이얼 조준으로 교체
- `main.js` → 게임루프 좀비/벽/타워 업데이트 추가

### New Files
- `zombies.js` - 좀비 클래스, AI, 스폰 시스템
- `wall.js` - 성벽 4구간 관리, 렌더링
- `tower.js` - 타워 상태, 렌더링
- `daynight.js` - 낮밤 사이클, 손전등 효과
